# netty framework tips

- nio的类库和api使用起来比较麻烦，还必须对多线程等方面有很好的了解。
- nio本身还有bug。netty本身的api比较简单。
- 定制性很强。

- 提供了三种线程模型

## reactor 线程模型

### 单线程模型：所有的IO操作都由同一个NIO线程处理

- 单个线程用于接收所有的链接，只能满足小型的场景

- 缺点： 性能上不能满足特别大的负载，当负荷过大，整体的处理速度就会下降，然后客户端连接时就会超时，这个客户端就会重试，频繁的重试会更加的加重服务器的负载，这样就会恶性循环

### 多线程模型： 有一组NIO线程处理IO操作

将原先的reactor单线程拆分成为了两块：

- *一个是一个单线程* ： 处理客户端链接，将客户端丢给后面的线程池，处理客户端连接请求
- *另一个是一个线程池* ：处理读写请求

### 主从线程模型：一组线程池接受请求，一组线程池处理IO

- 主线程池 ：当服务端接收到客户端请求，然后就会将这些连接注册到从（IO）线程池中，当链路建立完成后，剩下的工作就会由从线程池去操作
- 从线程池 ：编解码，读写



## 编写简单的netty服务的过程

- 构建一对主从线程组
- 定义服务器启动类
- 为服务设置Channel
- 设置处理从线程池的助手类初始化器
- 监听启动和关闭服务器